<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving a Power Flow · PowerFlows.jl</title><meta name="title" content="Solving a Power Flow · PowerFlows.jl"/><meta property="og:title" content="Solving a Power Flow · PowerFlows.jl"/><meta property="twitter:title" content="Solving a Power Flow · PowerFlows.jl"/><meta name="description" content="Documentation for PowerFlows.jl."/><meta property="og:description" content="Documentation for PowerFlows.jl."/><meta property="twitter:description" content="Documentation for PowerFlows.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PowerFlows.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PowerFlows.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><a class="tocitem" href="../../how-tos/stub/">How-to-Guides</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Solving a Power Flow</a><ul class="internal"><li><a class="tocitem" href="#Building-a-System"><span>Building a System</span></a></li><li><a class="tocitem" href="#DC-Power-Flow"><span>DC Power Flow</span></a></li><li><a class="tocitem" href="#PTDF-DC-Power-Flow"><span>PTDF DC Power Flow</span></a></li><li><a class="tocitem" href="#AC-Power-Flow"><span>AC Power Flow</span></a></li><li><a class="tocitem" href="#When-AC-Power-Flow-Fails"><span>When AC Power Flow Fails</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../explanation/stub/">Explanation</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/developers/developer/">Code Base Developer Guide</a></li><li><a class="tocitem" href="../../reference/developers/lcc_model/">LCC Model Implementation</a></li><li><a class="tocitem" href="../../reference/api/public/">Public API Reference</a></li><li><a class="tocitem" href="../../reference/api/internal/">Internal API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Solving a Power Flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving a Power Flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerFlows.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerFlows.jl/blob/main/docs/src/tutorials/solving-a-power-flow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-a-Power-Flow"><a class="docs-heading-anchor" href="#Solving-a-Power-Flow">Solving a Power Flow</a><a id="Solving-a-Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-a-Power-Flow" title="Permalink"></a></h1><p>In this tutorial, you&#39;ll solve power flows on a 5-bus test system using three different solvers and compare their results.</p><h2 id="Building-a-System"><a class="docs-heading-anchor" href="#Building-a-System">Building a System</a><a id="Building-a-System-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-System" title="Permalink"></a></h2><p>To get started, load the needed packages. We&#39;re using a standard test system and want to  keep output clean, so we adjust the logging settings to filter out a few precautionary warnings.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PowerSystemCaseBuilder</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PowerFlows</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PowerSystems</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Logging</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; disable_logging(Logging.Warn)</code><code class="nohighlight hljs ansi" style="display:block;">LogLevel(1001)</code></pre><p>Create a <a href="https://nrel-sienna.github.io/PowerSystems.jl/stable/api/public/#PowerSystems.System"><code>System</code></a> from <a href="https://github.com/NREL-Sienna/PowerSystemCaseBuilder.jl">PowerSystemCaseBuilder.jl</a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; sys = build_system(MatpowerTestSystems, &quot;matpower_case5_sys&quot;)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">              System</span>
┌───────────────────┬─────────────┐
│<span class="sgr1"> Property          </span>│<span class="sgr1"> Value       </span>│
├───────────────────┼─────────────┤
│ Name              │             │
│ Description       │             │
│ System Units Base │ SYSTEM_BASE │
│ Base Power        │ 100.0       │
│ Base Frequency    │ 60.0        │
│ Num Components    │ 28          │
└───────────────────┴─────────────┘

<span class="sgr1">         Static Components</span>
┌──────────────────────────┬───────┐
│<span class="sgr1"> Type                     </span>│<span class="sgr1"> Count </span>│
├──────────────────────────┼───────┤
│ ACBus                    │ 5     │
│ Arc                      │ 6     │
│ Area                     │ 1     │
│ Line                     │ 5     │
│ LoadZone                 │ 1     │
│ PhaseShiftingTransformer │ 2     │
│ PowerLoad                │ 3     │
│ ThermalStandard          │ 5     │
└──────────────────────────┴───────┘</code></pre><h2 id="DC-Power-Flow"><a class="docs-heading-anchor" href="#DC-Power-Flow">DC Power Flow</a><a id="DC-Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#DC-Power-Flow" title="Permalink"></a></h2><p><a href="../../reference/api/public/#PowerFlows.DCPowerFlow"><code>DCPowerFlow</code></a> solves for bus voltage angles using the bus admittance matrix,  then computes branch flows from the angle differences. Create a <a href="../../reference/api/public/#PowerFlows.DCPowerFlow"><code>DCPowerFlow</code></a> solver:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; pf_dc = DCPowerFlow()</code><code class="nohighlight hljs ansi" style="display:block;">DCPowerFlow(nothing, PowerNetworkMatrices.NetworkReduction[], 1, String[], false)</code></pre><p>Solve the power flow with <a href="../../reference/api/public/#PowerFlows.solve_power_flow-Tuple{Union{PowerFlows.PowerFlowData{DCPowerFlow, PowerNetworkMatrices.DC_ABA_Matrix_Factorized, PowerNetworkMatrices.DC_BA_Matrix}, PowerFlows.PowerFlowData{PTDFDCPowerFlow, PowerNetworkMatrices.DC_PTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}, PowerFlows.PowerFlowData{vPTDFDCPowerFlow, &lt;:PowerNetworkMatrices.DC_vPTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}}, System, FlowReporting}"><code>solve_power_flow</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; dc_results = solve_power_flow(pf_dc, sys)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching solve_power_flow(::DCPowerFlow, ::System)
The function `solve_power_flow` exists, but no method is defined for this combination of argument types.

Closest candidates are:
  solve_power_flow(::T, ::System, <span class="sgr91">::FlowReporting</span>) where T&lt;:AbstractDCPowerFlow
<span class="sgr90">   @</span> <span class="sgr35">PowerFlows</span> <span class="sgr90">~/work/PowerFlows.jl/PowerFlows.jl/src/<span class="sgr4">solve_dc_power_flow.jl:155</span></span>
  solve_power_flow(<span class="sgr91">::Union{PowerFlows.PowerFlowData{DCPowerFlow, PowerNetworkMatrices.DC_ABA_Matrix_Factorized, PowerNetworkMatrices.DC_BA_Matrix}, PowerFlows.PowerFlowData{PTDFDCPowerFlow, PowerNetworkMatrices.DC_PTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}, PowerFlows.PowerFlowData{vPTDFDCPowerFlow, &lt;:PowerNetworkMatrices.DC_vPTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}}</span>, ::System, <span class="sgr91">::FlowReporting</span>)
<span class="sgr90">   @</span> <span class="sgr35">PowerFlows</span> <span class="sgr90">~/work/PowerFlows.jl/PowerFlows.jl/src/<span class="sgr4">solve_dc_power_flow.jl:199</span></span>
  solve_power_flow(<span class="sgr91">::ACPowerFlow</span>, ::System; kwargs...)
<span class="sgr90">   @</span> <span class="sgr35">PowerFlows</span> <span class="sgr90">~/work/PowerFlows.jl/PowerFlows.jl/src/<span class="sgr4">solve_ac_power_flow.jl:78</span></span></code></pre><p>The result is a <code>Dict{String, Dict{String, DataFrame}}</code>. The outer key is the time step name: <code>&quot;1&quot;</code>. The inner dictionary stores the power flow results at that time step: <code>&quot;bus_results&quot;</code> for bus data and <code>&quot;flow_results&quot;</code> key for AC line data. (There&#39;s also 3rd key, <code>&quot;lcc_results&quot;</code>, for HVDC lines, but this sytem  contains no such components, so the matching dataframe will be emtpy.) Inspect <code>&quot;bus_results&quot;</code>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; dc_results[&quot;1&quot;][&quot;bus_results&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `dc_results` not defined in `Main`
Suggestion: add an appropriate import or assignment. This global was declared but not assigned.</code></pre><p>Notice that <code>Vm</code> (voltage magnitude) is 1.0 for all buses, and <code>Q_gen</code> and <code>Q_load</code> are 0. This is expected for DC power flow, which assumes flat voltage magnitudes and ignores reactive power.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; dc_results[&quot;1&quot;][&quot;flow_results&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `dc_results` not defined in `Main`
Suggestion: add an appropriate import or assignment. This global was declared but not assigned.</code></pre><p>Likewise, <code>Q_from_to</code> and <code>Q_to_from</code> (reactive power flow on the line) are zero, for all lines.</p><h2 id="PTDF-DC-Power-Flow"><a class="docs-heading-anchor" href="#PTDF-DC-Power-Flow">PTDF DC Power Flow</a><a id="PTDF-DC-Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#PTDF-DC-Power-Flow" title="Permalink"></a></h2><p><a href="../../reference/api/public/#PowerFlows.PTDFDCPowerFlow"><code>PTDFDCPowerFlow</code></a> computes branch flows directly from bus power injections using the Power Transfer Distribution Factor matrix, without solving for voltage angles as an intermediate step. (This means we can omit the angle computation in contexts where we only  care about line flows, though we don&#39;t have that option implemented here.) Create a <a href="../../reference/api/public/#PowerFlows.PTDFDCPowerFlow"><code>PTDFDCPowerFlow</code></a> solver:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; pf_ptdf = PTDFPowerFlow()</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `PTDFPowerFlow` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>As before, solve the power flow with <a href="../../reference/api/public/#PowerFlows.solve_power_flow-Tuple{Union{PowerFlows.PowerFlowData{DCPowerFlow, PowerNetworkMatrices.DC_ABA_Matrix_Factorized, PowerNetworkMatrices.DC_BA_Matrix}, PowerFlows.PowerFlowData{PTDFDCPowerFlow, PowerNetworkMatrices.DC_PTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}, PowerFlows.PowerFlowData{vPTDFDCPowerFlow, &lt;:PowerNetworkMatrices.DC_vPTDF_Matrix, PowerNetworkMatrices.DC_ABA_Matrix_Factorized}}, System, FlowReporting}"><code>solve_power_flow</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; dc_results = solve_power_flow(pf_ptdf, sys)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `pf_ptdf` not defined in `Main`
Suggestion: add an appropriate import or assignment. This global was declared but not assigned.</code></pre><p>Look at the bus results:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ptdf_results[&quot;1&quot;][&quot;bus_results&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `ptdf_results` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>The results match <code>DCPowerFlow</code>, as they should: the two are mathematically equivalent.  For very large systems where forming the full PTDF matrix would be too expensive,  consider <a href="../../reference/api/public/#PowerFlows.vPTDFDCPowerFlow"><code>vPTDFDCPowerFlow</code></a>, which computes the same results without  storing the dense matrix.</p><h2 id="AC-Power-Flow"><a class="docs-heading-anchor" href="#AC-Power-Flow">AC Power Flow</a><a id="AC-Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#AC-Power-Flow" title="Permalink"></a></h2><p>Create an <a href="../../reference/api/public/#PowerFlows.ACPowerFlow"><code>ACPowerFlow</code></a> solver:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; pf_ac = ACPowerFlow()</code><code class="nohighlight hljs ansi" style="display:block;">ACPowerFlow{NewtonRaphsonACPowerFlow}(false, nothing, false, false, nothing, true, false, false, PowerNetworkMatrices.NetworkReduction[], 1, String[], false, Dict{Symbol, Any}())</code></pre><p>Solve the power flow:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; solve_power_flow(pf_ac, sys)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, DataFrames.DataFrame} with 3 entries:
  &quot;flow_results&quot; =&gt; <span class="sgr1">6×9 DataFrame</span>…
  &quot;bus_results&quot;  =&gt; <span class="sgr1">5×9 DataFrame</span>…
  &quot;lcc_results&quot;  =&gt; <span class="sgr1">0×13 DataFrame</span>…</code></pre><p>AC results are returned as a flat <code>Dict{String, DataFrame}</code>, with the same keys as  before: <code>&quot;bus_results&quot;</code>, <code>&quot;flow_results&quot;</code> (AC lines), and <code>&quot;lcc_results&quot;</code> (HVDC lines).  (We don&#39;t support multi-period AC power flows yet.) Look at the bus results:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ac_results[&quot;bus_results&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `ac_results` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>Notice that <code>Vm</code> now varies across buses (not all 1.0), and <code>Q_gen</code> has non-zero values.</p><p>Look at the line flows:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ac_results[&quot;flow_results&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `ac_results` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p><code>Q_from_to</code> and <code>Q_to_from</code> now show reactive power flows, and <code>P_from_to</code> differs from <code>P_to_from</code> due to losses.</p><h2 id="When-AC-Power-Flow-Fails"><a class="docs-heading-anchor" href="#When-AC-Power-Flow-Fails">When AC Power Flow Fails</a><a id="When-AC-Power-Flow-Fails-1"></a><a class="docs-heading-anchor-permalink" href="#When-AC-Power-Flow-Fails" title="Permalink"></a></h2><p>Unlike DC power flow, AC power flow is iterative and not guaranteed to converge. Systems with high impedance lines, poor initial voltage profiles, or insufficient reactive power support can cause the solver to fail. When this happens, <code>solve_power_flow</code> returns <code>missing</code>: you&#39;ll also see a logged error. If you encounter convergence failures, consider  using a more robust solver such as <a href="../../reference/api/public/#PowerFlows.TrustRegionACPowerFlow"><code>TrustRegionACPowerFlow</code></a> or <a href="../../reference/api/public/#PowerFlows.RobustHomotopyPowerFlow"><code>RobustHomotopyPowerFlow</code></a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../how-tos/stub/">« How-to-Guides</a><a class="docs-footer-nextpage" href="../../explanation/stub/">Explanation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 21:55">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
