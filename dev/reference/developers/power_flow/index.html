<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Power Flow · PowerFlows.jl</title><meta name="title" content="Power Flow · PowerFlows.jl"/><meta property="og:title" content="Power Flow · PowerFlows.jl"/><meta property="twitter:title" content="Power Flow · PowerFlows.jl"/><meta name="description" content="Documentation for PowerFlows.jl."/><meta property="og:description" content="Documentation for PowerFlows.jl."/><meta property="twitter:description" content="Documentation for PowerFlows.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="PowerFlows.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">PowerFlows.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Welcome Page</a></li><li><a class="tocitem" href="../../../how-tos/stub/">How-to-Guides</a></li><li><a class="tocitem" href="../../../tutorials/stub/">Tutorials</a></li><li><a class="tocitem" href="../../../explanation/stub/">Explanation</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../developer/">Code Base Developer Guide</a></li><li><a class="tocitem" href="../../api/public/">Public API Reference</a></li><li><a class="tocitem" href="../../api/internal/">Internal API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Power Flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Power Flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerFlows.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerFlows.jl/blob/main/docs/src/reference/developers/power_flow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Power-Flow"><a class="docs-heading-anchor" href="#Power-Flow">Power Flow</a><a id="Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Flow" title="Permalink"></a></h1><p><code>PowerFlows.jl</code> provides the capability to run a power flow using the <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton-Raphson method</a>, optionally enforcing reactive power constraints of generators. This power flow routine can be used to check for AC feasibility of results of DC optimal power flow.</p><p>The power flow solver uses <a href="https://github.com/JuliaSparse/KLU.jl">KLU.jl</a> for Jacobian matrix factorization. The solver uses the current operating point in the buses to provide the initial guess. The initial guess is then adjusted to contain voltage magnitudes within a feasible range of 0.8 p.u. - 1.2 p.u.</p><p><strong>Limitations</strong>: The PowerFlow solver doesn&#39;t support systems with HVDC lines or Phase Shifting transformers yet. The power flow solver can&#39;t handle systems with islands.</p><pre><code class="language-julia hljs">using PowerFlows
using PowerSystems
using PowerSystemCaseBuilder

system_data = build_system(PSITestSystems, &quot;c_sys14&quot;)</code></pre><table>
  <caption style = "text-align: left;">System</caption>
  <thead>
    <tr class = "header headerLastRow">
      <th style = "text-align: left;">Property</th>
      <th style = "text-align: left;">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style = "text-align: left;">Name</td>
      <td style = "text-align: left;"></td>
    </tr>
    <tr>
      <td style = "text-align: left;">Description</td>
      <td style = "text-align: left;"></td>
    </tr>
    <tr>
      <td style = "text-align: left;">System Units Base</td>
      <td style = "text-align: left;">SYSTEM_BASE</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Base Power</td>
      <td style = "text-align: left;">100.0</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Base Frequency</td>
      <td style = "text-align: left;">60.0</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Num Components</td>
      <td style = "text-align: left;">70</td>
    </tr>
  </tbody>
</table>

<table>
  <caption style = "text-align: left;">Static Components</caption>
  <thead>
    <tr class = "header headerLastRow">
      <th style = "text-align: left;">Type</th>
      <th style = "text-align: left;">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style = "text-align: left;">ACBus</td>
      <td style = "text-align: left;">14</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Arc</td>
      <td style = "text-align: left;">20</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Line</td>
      <td style = "text-align: left;">16</td>
    </tr>
    <tr>
      <td style = "text-align: left;">PowerLoad</td>
      <td style = "text-align: left;">11</td>
    </tr>
    <tr>
      <td style = "text-align: left;">TapTransformer</td>
      <td style = "text-align: left;">3</td>
    </tr>
    <tr>
      <td style = "text-align: left;">ThermalStandard</td>
      <td style = "text-align: left;">5</td>
    </tr>
    <tr>
      <td style = "text-align: left;">Transformer2W</td>
      <td style = "text-align: left;">1</td>
    </tr>
  </tbody>
</table>

<table>
  <caption style = "text-align: left;">Forecast Summary</caption>
  <thead>
    <tr class = "header">
      <th style = "text-align: left;">owner_type</th>
      <th style = "text-align: left;">owner_category</th>
      <th style = "text-align: left;">time_series_type</th>
      <th style = "text-align: left;">initial_timestamp</th>
      <th style = "text-align: left;">resolution</th>
      <th style = "text-align: left;">count</th>
      <th style = "text-align: left;">horizon</th>
      <th style = "text-align: left;">interval</th>
      <th style = "text-align: left;">window_count</th>
    </tr>
    <tr class = "subheader headerLastRow">
      <th style = "text-align: left;">String</th>
      <th style = "text-align: left;">String</th>
      <th style = "text-align: left;">String</th>
      <th style = "text-align: left;">String</th>
      <th style = "text-align: left;">Dates.CompoundPeriod</th>
      <th style = "text-align: left;">Int64</th>
      <th style = "text-align: left;">Dates.CompoundPeriod</th>
      <th style = "text-align: left;">Dates.CompoundPeriod</th>
      <th style = "text-align: left;">Int64</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style = "text-align: left;">PowerLoad</td>
      <td style = "text-align: left;">Component</td>
      <td style = "text-align: left;">Deterministic</td>
      <td style = "text-align: left;">2024-01-01T00:00:00</td>
      <td style = "text-align: left;">1 hour</td>
      <td style = "text-align: left;">11</td>
      <td style = "text-align: left;">1 day</td>
      <td style = "text-align: left;">empty period</td>
      <td style = "text-align: left;">1</td>
    </tr>
  </tbody>
</table>
<p><code>PowerFlows.jl</code> has two modes of using the power flow solver.</p><ol><li><p>Solving the power flow for the current operating point in the system. Takes the data in the buses, the <code>active_power</code> and <code>reactive_power</code> fields in the static injection devices. Returns a dictionary with results in a DataFrame that can be exported or manipulated as needed.</p></li><li><p>Solves the power flow and updated the devices in the system to the operating condition. This model will update the values of magnitudes and angles in the system&#39;s buses. It also updates the active and reactive power flows in the branches and devices connected to PV buses. It also updates the active and reactive power of the injection devices connected to the Slack bus, and updates only the reactive power of the injection devices connected to PV buses. If multiple devices are connected to the same bus, the power is divided proportional to the base power. This utility is useful to initialize systems before serializing or checking the addition of new devices is still AC feasible.</p></li></ol><p>Solving the power flow with mode 1:</p><pre><code class="language-julia hljs">pf = ACPowerFlow()
results = solve_powerflow(pf, system_data)
results[&quot;bus_results&quot;]</code></pre><div><div style = "float: left;"><span>14×9 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">bus_number</th><th style = "text-align: left;">Vm</th><th style = "text-align: left;">θ</th><th style = "text-align: left;">P_gen</th><th style = "text-align: left;">P_load</th><th style = "text-align: left;">P_net</th><th style = "text-align: left;">Q_gen</th><th style = "text-align: left;">Q_load</th><th style = "text-align: left;">Q_net</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1.06</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">232.551</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">232.551</td><td style = "text-align: right;">-15.5293</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-15.5293</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1.045</td><td style = "text-align: right;">-0.0870457</td><td style = "text-align: right;">40.0</td><td style = "text-align: right;">21.7</td><td style = "text-align: right;">18.3</td><td style = "text-align: right;">46.9214</td><td style = "text-align: right;">12.7</td><td style = "text-align: right;">34.2214</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1.01</td><td style = "text-align: right;">-0.222398</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">94.2</td><td style = "text-align: right;">-94.2</td><td style = "text-align: right;">27.1364</td><td style = "text-align: right;">19.0</td><td style = "text-align: right;">8.13639</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">1.01423</td><td style = "text-align: right;">-0.179009</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">47.8</td><td style = "text-align: right;">-47.8</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-3.9</td><td style = "text-align: right;">3.9</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">1.01724</td><td style = "text-align: right;">-0.152972</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">7.6</td><td style = "text-align: right;">-7.6</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.6</td><td style = "text-align: right;">-1.6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">6</td><td style = "text-align: right;">1.07</td><td style = "text-align: right;">-0.251637</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">11.2</td><td style = "text-align: right;">-11.2</td><td style = "text-align: right;">21.6039</td><td style = "text-align: right;">7.5</td><td style = "text-align: right;">14.1039</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">7</td><td style = "text-align: right;">1.05034</td><td style = "text-align: right;">-0.231289</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">8</td><td style = "text-align: right;">1.09</td><td style = "text-align: right;">-0.231289</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">24.5388</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">24.5388</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">9</td><td style = "text-align: right;">1.03371</td><td style = "text-align: right;">-0.258872</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">29.5</td><td style = "text-align: right;">-29.5</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">16.6</td><td style = "text-align: right;">-16.6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">10</td><td style = "text-align: right;">1.03256</td><td style = "text-align: right;">-0.262519</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">9.0</td><td style = "text-align: right;">-9.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">5.8</td><td style = "text-align: right;">-5.8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">11</td><td style = "text-align: right;">1.04748</td><td style = "text-align: right;">-0.259143</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">3.5</td><td style = "text-align: right;">-3.5</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.8</td><td style = "text-align: right;">-1.8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: right;">12</td><td style = "text-align: right;">1.0535</td><td style = "text-align: right;">-0.266484</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">6.1</td><td style = "text-align: right;">-6.1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.6</td><td style = "text-align: right;">-1.6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: right;">13</td><td style = "text-align: right;">1.04711</td><td style = "text-align: right;">-0.267177</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">13.5</td><td style = "text-align: right;">-13.5</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">5.8</td><td style = "text-align: right;">-5.8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: right;">14</td><td style = "text-align: right;">1.02131</td><td style = "text-align: right;">-0.280381</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">14.9</td><td style = "text-align: right;">-14.9</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">-5.0</td></tr></tbody></table></div><p>Solving the power flow with mode 2:</p><p>Before running the power flow command these are the values of the voltages:</p><pre><code class="language-julia hljs">for b in get_components(Bus, system_data)
    println(&quot;$(get_name(b)) - Magnitude $(get_magnitude(b)) - Angle (rad) $(get_angle(b))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Bus 6 - Magnitude 1.07 - Angle (rad) -0.24818581963359368
Bus 9 - Magnitude 1.056 - Angle (rad) -0.2607521902479528
Bus 12 - Magnitude 1.055 - Angle (rad) -0.2630211182755455
Bus 11 - Magnitude 1.057 - Angle (rad) -0.2581341963699613
Bus 7 - Magnitude 1.062 - Angle (rad) -0.23335052099164186
Bus 4 - Magnitude 1.019 - Angle (rad) -0.18029251173101424
Bus 13 - Magnitude 1.05 - Angle (rad) -0.2645919146023404
Bus 2 - Magnitude 1.045 - Angle (rad) -0.08691739674931762
Bus 14 - Magnitude 1.036 - Angle (rad) -0.27995081201989047
Bus 8 - Magnitude 1.09 - Angle (rad) -0.2331759880664424
Bus 10 - Magnitude 1.051 - Angle (rad) -0.26354471705114374
Bus 3 - Magnitude 1.01 - Angle (rad) -0.22200588085367873
Bus 1 - Magnitude 1.06 - Angle (rad) 0.0
Bus 5 - Magnitude 1.02 - Angle (rad) -0.15323990832510212</code></pre><p><a href="../../api/public/#PowerFlows.solve_powerflow!-Tuple{ACPowerFlow, System}"><code>solve_powerflow!</code></a> return true or false to signal the successful result of the power flow. This enables the integration of a power flow into functions and use the return as check.</p><pre><code class="language-julia hljs">solve_powerflow!(pf, system_data; method = :newton)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>After running the power flow command this are the values of the voltages:</p><pre><code class="language-julia hljs">for b in get_components(Bus, system_data)
    println(&quot;$(get_name(b)) - Magnitude $(get_magnitude(b)) - Angle (rad) $(get_angle(b))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Bus 6 - Magnitude 1.07 - Angle (rad) -0.2516366411330646
Bus 9 - Magnitude 1.0337109552890458 - Angle (rad) -0.258872010045685
Bus 12 - Magnitude 1.0535012072934002 - Angle (rad) -0.2664843379356399
Bus 11 - Magnitude 1.0474837090281965 - Angle (rad) -0.2591425488889482
Bus 7 - Magnitude 1.0503438761049337 - Angle (rad) -0.23128945395825587
Bus 4 - Magnitude 1.014232467422514 - Angle (rad) -0.1790087810058283
Bus 13 - Magnitude 1.0471069158440356 - Angle (rad) -0.26717690246620607
Bus 2 - Magnitude 1.045 - Angle (rad) -0.08704571860678871
Bus 14 - Magnitude 1.0213119628726424 - Angle (rad) -0.2803812119374238
Bus 8 - Magnitude 1.09 - Angle (rad) -0.23128945395825584
Bus 10 - Magnitude 1.0325606430799592 - Angle (rad) -0.2625186014967187
Bus 3 - Magnitude 1.01 - Angle (rad) -0.2223975252270974
Bus 1 - Magnitude 1.06 - Angle (rad) 0.0
Bus 5 - Magnitude 1.0172382900002028 - Angle (rad) -0.15297197376986674</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Friday 2 May 2025 00:09">Friday 2 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
